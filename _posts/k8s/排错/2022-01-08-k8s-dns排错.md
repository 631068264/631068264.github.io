---
layout:     post
rewards: false
title:   Kubernetes 中 Pod 无法正常解析域名
categories:
    - k8s
---

连接svc timeout，通过ip连接没有问题。

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: dnsutils
spec:
  containers:
  - name: dnsutils
    image: mydlqclub/dnsutils:1.3
    imagePullPolicy: IfNotPresent
    command: ["sleep","3600"]
```



```sh
# 部署到问题namespace image 包含ping nslookup netstat 
kubectl create -f ndsutils.yaml -n xxx
kubectl exec -it dnsutils /bin/sh -n xxx
```



```sh
# 查看coredns运行情况
kubectl get pods -l k8s-app=kube-dns -n kube-system
kubectl logs -n kube-system pod name
kubectl get service -n kube-system | grep kube-dns

kubectl get endpoints kube-dns -n kube-system
```

- https://www.gylinux.cn/4299.html
