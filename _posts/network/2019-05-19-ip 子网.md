---
layout:     post
rewards: false
title:      ip 子网
categories:
    - network
tags:
    - network
---

# IP段

- A类IP段　 0.0.0.0 到127.255.255.255 
- B类IP段　128.0.0.0 到191.255.255.255 
- C类IP段　192.0.0.0 到223.255.255.255 

默认分配的子网掩码每段只有255或0

- Ａ类的默认子网掩码　255.0.0.0　　　　　一个子网最多可以容纳1677万多台电脑 
- Ｂ类的默认子网掩码　255.255.0.0　　　　一个子网最多可以容纳6万台电脑 
- Ｃ类的默认子网掩码　255.255.255.0　　　一个子网最多可以容纳254台电脑

> 子网掩码 & IP地址=网络标识  网络标识一样，那么属于同一网段


# ip/num

/num 是子网掩码表示方法 表示1的个数

```
192.168.0.0/24 => 11000000.10101000.00000000.00000000/24
```

ip有13位 num 取值范围[13,32]  总个数 `2**(32-num)`


```python
net = 12
network = ip_range(f'192.168.0.0/{net}')
ip2bin = lambda ip: '.'.join([bin(int(x) + 256)[3:] for x in ip.split('.')])
print(ip2bin('192.168.0.0'))

>>> 11000000.10101000.00000000.00000000

e = list(network)
print(str(min(e)), str(max(e)))

>>> 192.168.0.0 192.175.255.255

n = 2**(32-net)
l = len(e)
assert n == l

```


# ip util

```
def test_is_ip_interface():
    assert is_ip_interface('127.0.0.1') is True
    assert is_ip_interface('127.0.0.0/24') is True
    assert is_ip_interface('test') is False


def test_ip_range():
    network = ip_range('192.168.0.0/28')
    assert str(network) == '192.168.0.0/28'
    assert str(min(network)) == '192.168.0.0'
    assert str(max(network)) == '192.168.0.15'
    assert min(network) < ip('192.168.0.4') < max(network)

    network = ip_range('192.168.0.0/98')
    assert network is None

    assert ipaddress.ip_address('10.118.0.18') in ip_range('10.118.0.0/22')


def test_ipv6():
    f = ip('1050:0:0:0:5:600:300c:326b')
    b = f.packed
    assert str(ip(b)) == '1050::5:600:300c:326b'

    f = ip_range('2001:0:0:CD30::/123')
    c = ip('2001:0:0:CD30::10')
    assert c in f
    a, b = str(min(f)), str(max(f))
    assert a == '2001:0:0:cd30::'
    assert b == '2001:0:0:cd30::1f'

    assert min(f).packed < c.packed < max(f).packed

```
 

