---
layout:     post
rewards: false
title:      go 锁
categories:
    - go
tags:
    - go
---

# sync.Mutex

互斥锁 同一时间只能有一个线程进入

当你使用mutex时，确保mutex和其保护的变量没有被导出

```go
 
import "sync"

type Info struct {
	mu sync.Mutex
	// ... other fields, e.g.: Str string
}

func Update(info *Info) {
	info.mu.Lock()
    // critical section:
    info.Str = // new value
    // end critical section
    info.mu.Unlock()
}


```

# sync.RWMutex读写锁

针对读写操作的互斥锁，它可以分别针对读操作和写操作进行锁定和解锁操作。读写锁遵循的访问控制规则与互斥锁有所不同。

使用情况**多读单写** 多个只读操作并行执行，但写操作会完全互斥。